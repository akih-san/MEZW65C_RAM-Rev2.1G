# MEZW65C_RAM-Rev2.1G

工事中( - Under construction - )
<br>
MEZW65C_RAM-Rev2.1（PCB Rev1.3)からの改良点<br>
<br>
１．ＣＰＵの高速化<br>
２．ＣＰＬＤ（ＧＡＬ）導入によるＰＣＢの部品点数を削減<br>
３．ファームウェアによる6502、65816の自動判定<br>

# １．ＣＰＵの高速化
<br>
Rev2.1(PCB Rev1.3)は、6502(8MHz)、65816(6MHz)で動作しています。<br>
しかし、W65C02S6TPG-14とW65C816S6TPG-14を定格のは14MHzです。<br>
使用しているSRAM(AS6C4008-55PCN)のアクセスタイムは55nsですから、<br>
もう少し早く動かすことが出来るはずです。<br>
色々調べた結果、少し回路を修正すれば出来そうです。<br>
その為には、標準ロジックICを追加する必要がありますが、<br>
PCB Rev1.3には面積的にICを追加することは不可能な状況でした。<br>
<br>
（余談）
14MHzで動かすには、もっと高速なSRAMが必要です。<br>
X(旧Twitter)の@DragonBallEZさんが、MH678127UHJ-12の高速SRAM
（以前は秋月電子通商さんで入手出来ましたが、販売終了で入手は困難です）
をAS6C1008のピン配置に変換するアダプタ(Little Demon1 Rev0.3)を
作成しているので、それを使って実験したところ、14MHzで動作することが
確認出来ました。



<br>

# ２．ＣＰＬＤ（ＧＡＬ）導入によるＰＣＢの部品点数を削減
<br>
Glue logicは、CPLDを使えば複数の標準ロジックICを、規模にもよりますが<br>
１つにまとめることが可能です。<br>
PCB Rev1.3には３つの標準ロジックICがあります。追加のGlue logicと<br>
３つの標準ロジックICを、１つの22V10タイプのCPLDにまとめることが出来ました。<br>
CPLDは、私自信にとって初めての挑戦でしたが、うまくいきました。<br>


# ３．ファームウェアによる6502、65816の自動判定<br>




(ATF22V10C-7PX)GAL22V20B-15LP






6502の動作タイミングダイアグラムは、クロック1サイクルで完結しています。
他のＣＰＵが、数クロックのＣＰＵサイクルを持つのに比べて、非常にシンプル
な設計となっています。
このことが、6502が16ビットレジスタを持たず、レジスタ数も他のCPUに比べて
極めて少ないにも関わらず、高速動作する最も基本的な理由だと思います。
65816になり、16ビットレジスタの拡張と、メモリ空間の拡張が行われています。
にも拘わらず、動作タイミングダイアグラムは、クロック1サイクルで完結しています。
このため、6502に比べて、メモリアクセスへの要求仕様がかなりシビアとなっています。
前半の半サイクルで（バンク）アドレス確定、後半の半サイクルでリード、ライトを
実行する、つまり14MHzでは乱暴に言って、35.7nsでアドレス確定し、残りの35.7ns
でデータのリードライトを行っています。
35.7nsの時間幅でアドレス、データのsetup, hold, valid data time
そして、接続するSRAMの動作タイミングが絡み合うので、タイミングの設計が非常に
シビアになります。
